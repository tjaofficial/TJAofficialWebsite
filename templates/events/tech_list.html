{% extends 'controlpanel/dashboard.html' %}{% load static %}
{% block title %}Tech Directory{% endblock %}
{% block content %}
<h1>Tech Directory</h1>
<form method="get" class="card">
  <div class="form-row">
    <input class="input" name="q" placeholder="Name/email/phone" value="{{ q.q }}">
    <select class="input" name="role">
      <option value="">Role: Any</option>
      <option value="sound" {% if q.role == 'sound' %}selected{% endif %}>Sound</option>
      <option value="lighting" {% if q.role == 'lighting' %}selected{% endif %}>Lighting</option>
      <option value="guitarist" {% if q.role == 'guitarist' %}selected{% endif %}>Guitarist</option>
      <option value="drummer" {% if q.role == 'drummer' %}selected{% endif %}>Drummer</option>
      <option value="engineer" {% if q.role == 'engineer' %}selected{% endif %}>Engineer</option>
      <option value="stagehand" {% if q.role == 'stagehand' %}selected{% endif %}>Stagehand</option>
      <option value="other" {% if q.role == 'other' %}selected{% endif %}>Other</option>
    </select>
    <input class="input" name="city" placeholder="City" value="{{ q.city }}">
    <input class="input" name="state" placeholder="State" value="{{ q.state }}">
    <button class="btn primary">Filter</button>
    <a class="btn" href="{% url 'control:events:tech_add' %}">Add Tech</a>
  </div>
</form>
<div class="card">
  <table class="table">
    <thead><tr><th>Name</th><th>Role</th><th>Location</th><th>Rate</th><th>Contact</th><th></th></tr></thead>
    <tbody>
      {% for p in tech %}
      <tr>
        <td>{{ p.name }}</td>
        <td>{{ p.get_role_display }}</td>
        <td>{{ p.city }}, {{ p.state }}</td>
        <td>${{ p.rate_cents|floatformat:-2 }}</td>
        <td>{{ p.email }} {% if p.phone %} / {{ p.phone }}{% endif %}</td>
        <td><a class="btn" href="{% url 'control:events:tech_edit' p.id %}">Edit</a></td>
      </tr>
      {% empty %}
      <tr><td colspan="6" class="muted">No tech found.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
